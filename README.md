# Implementation of Multi-camera vehicle tracking and re-identification based on visual and spatial-temporal features for 2019 AICity Challenge 
This repository contains the source codes of detection, single camera tracking and vehicle reid of our implementation for 2019 AICity Challenge, and we achieve the top 1 in the vehicle reid task.

## Dependencies
python 2.7  
pytorch 1.0  
refer to our source codes for other dependencies  

## Datasets
Datasets used in our implementation are avialable at [datasets](https://pan.baidu.com/s/1jmvV8GiHfRkpiNlXEvbHdw) (extract code: k1m4) or [google drive](https://drive.google.com/drive/folders/1lckEFvsRVjJXsNoS3fV4m5z8BqLzOFUN?usp=sharing) which includes aicity_attribute.tar.gz (used for vehicle type classification), aicity_train_direction.tar.gz (used for vehicle orientation classification), complete_aicity_car196.tar.gz (used for training vehicle reid models), gao_crop_train.tar.gz (the crop image by applying our detector on our training set), gao_crop_query.tar.gz and gao_crop_gallery.tar.gz (the crop image by applying our detector on aicity_2019 testing set). Please refer to our paper for more details about the datasets. The images for training base vehicle reid models contain data for commercial usage, which will not be open source.  

## Some Important Pickle Files ##
Several important pickle files are also available at [pickle_file](https://pan.baidu.com/s/1u6d6dX0uPvyrqgOB0O4Qyg) (extract code: p3fg). These files will be introduced in different sub-folders.

## Code Structure ##

**Each part has its own README file.**

* SingleCameraTracking contains source codes of single camera tracking.

* Track2(ReID)/part1_model contains source codes of training vehicle type classification model, vehicle orientation classification model and three vehicle reid models including se_resnext101, resnet101 and se_resnet152.

* Track2(ReID)/part2_model contains the source codes of training three vehicle reid models including resnet50_sac, hrnet and MGN.

* Track2(ReID)/part3_model contains the source codes of training key-point based reid model.

* Track2(ReID)/utility_and_constraint_related_codes contain utility codes and constraint related codes.

## Qualitative Results ##
Some qualitative results of our method are listed below. The first column shows query images, the remaining columns demonstrate the corresponding top 7 ranking results. Images in red box are false positives and images in green box are true positives.

* Results generated by baseline mehtod (Resnet50 trained by softmax cross entropy loss and triplet loss).  
![image](https://github.com/wzgwzg/AICity/blob/master/quali_1.jpg)

* Results generated by our method.
![image](https://github.com/wzgwzg/AICity/blob/master/quali_2.jpg)
